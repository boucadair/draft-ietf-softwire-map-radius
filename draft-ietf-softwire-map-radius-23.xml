<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
     please see http://xml.resource.org/authoring/README.html. -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-ietf-softwire-map-radius-23"
     ipr="trust200902">
  <front>
    <title abbrev="A+P RADIUS Attributes">RADIUS Attributes for Address plus
    Port (A+P) based Softwire Mechanisms</title>

    <author fullname="Sheng Jiang" initials="S." surname="Jiang, Ed.">
      <organization>Huawei Technologies Co., Ltd</organization>

      <address>
        <postal>
          <street>Q14, Huawei Campus, No.156 Beiqing Road</street>

          <city>Hai-Dian District, Beijing, 100095</city>

          <country>P.R. China</country>
        </postal>

        <email>jiangsheng@huawei.com</email>
      </address>
    </author>

    <author fullname="Yu Fu" initials="Y." surname="Fu, Ed.">
      <organization>CNNIC</organization>

      <address>
        <postal>
          <street>No.4 South 4th Street, Zhongguancun</street>

          <city>Hai-Dian District, Beijing, 100190</city>

          <country>P.R. China</country>
        </postal>

        <email>eleven711711@foxmail.com</email>
      </address>
    </author>

    <author fullname="Peter Deacon" initials="P." surname="Deacon">
      <organization>IEA Software, Inc.</organization>

      <address>
        <postal>
          <street>P.O. Box 1170</street>

          <city>Veradale</city>

          <region>WA</region>

          <code>99037</code>

          <country>USA</country>
        </postal>

        <email>peterd@iea-software.com</email>
      </address>
    </author>

    <author fullname="Chongfeng Xie" initials="C." surname="Xie">
      <organization>China Telecom</organization>

      <address>
        <postal>
          <street></street>

          <city>Beijing</city>

          <code></code>

          <country>P.R. China</country>
        </postal>

        <email>xiechf.bri@chinatelecom.cn</email>
      </address>
    </author>

    <author fullname="Tianxiang Li" initials="T" surname="Li">
      <organization>Tsinghua University</organization>

      <address>
        <postal>
          <street></street>

          <city>Beijing</city>

          <code>100084</code>

          <country>P.R.China</country>
        </postal>

        <email>peter416733@gmail.com</email>
      </address>
    </author>

    <author fullname="Mohamed Boucadair" initials="M. " role="editor"
            surname="Boucadair">
      <organization>Orange</organization>

      <address>
        <postal>
          <street>Rennes, 35000</street>

          <city>France</city>

          <region></region>

          <code></code>

          <country></country>
        </postal>

        <phone></phone>

        <facsimile></facsimile>

        <email>mohamed.boucadair@orange.com</email>

        <uri></uri>
      </address>
    </author>

    <!--FIX AUTHOTS LIST///UPDATE CONTRIBUTORS SECTION-->

    <date month="May" year="2019" />

    <area>Internet Area</area>

    <workgroup>Softwire</workgroup>

    <keyword>IPv6 Transition, MAP-E, MAP-T, Lightweight 4over6, RADIUS,
    address sharing, authorization, AAA, provisioning</keyword>

    <abstract>
      <t>IPv4-over-IPv6 transition mechanisms provide IPv4 connectivity
      services over IPv6 native networks during the IPv4/IPv6 co-existence
      period. DHCPv6 options have been defined for configuring clients for
      Lightweight 4over6, Mapping of Address and Port with Encapsulation, and
      Mapping of Address and Port using Translation unicast softwire
      mechanisms, and also multicast softwires. However, in many networks,
      configuration information is stored in an Authentication, Authorization,
      and Accounting server which utilizes the RADIUS protocol to provide
      centralized management for users. When a new transition mechanism is
      developed, new RADIUS attributes need to be defined correspondingly.</t>

      <t>This document defines new RADIUS attributes to carry Address plus
      Port based softwire configuration parameters from an Authentication,
      Authorization, and Accounting server to a Broadband Network Gateway.
      Both unicast and multicast attributes are covered.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>Providers have started deploying and transitioning to IPv6. Several
      IPv4 service continuity mechanisms based on the Address plus Port (A+P)
      <xref target="RFC6346"></xref> have been proposed for providing unicast
      IPv4 over IPv6-only infrastructure, such as Mapping of Address and Port
      with Encapsulation (MAP-E) <xref target="RFC7597"></xref>, Mapping of
      Address and Port using Translation (MAP-T) <xref
      target="RFC7599"></xref>, and Lightweight 4over6 <xref
      target="RFC7596"></xref>. Also, <xref target="RFC8114"></xref> specifies
      a generic solution for the delivery of IPv4 multicast services to IPv4
      clients over an IPv6 multicast network. For each of these mechanisms,
      DHCPv6 options have been specified for client configuration.</t>

      <!--     -->

      <t>In many networks, user configuration information is stored in an
      Authentication, Authorization, and Accounting (AAA) server. AAA servers
      generally communicate using the Remote Authentication Dial In User
      Service (RADIUS) <xref target="RFC2865"></xref> protocol. In a fixed
      broadband network, a Broadband Network Gateway (BNG) acts as the access
      gateway for users. That is, the BNG acts as both an AAA client to the
      AAA server, and a DHCPv6 server for DHCPv6 messages sent by clients.
      Throughout this document, the term BNG describes a device implementing
      both the AAA client and DHCPv6 server functions.</t>

      <t>Since IPv4-in-IPv6 softwire configuration information is stored in an
      AAA server, and user configuration information is mainly transmitted
      through DHCPv6 protocol between the BNGs and Customer Premises Equipment
      (CEs, a.k.a., CPE), new RADIUS attributes are needed to propagate the
      information from the AAA servers to BNGs.</t>

      <t>The RADIUS attributes defined in this document provide configuration
      to populate the corresponding DHCPv6 options for unicast and multicast
      softwire configuration, specifically:</t>

      <t><list style="symbols">
          <t>"Mapping of Address and Port with Encapsulation (MAP-E)" <xref
          target="RFC7597"></xref> (DHCPv6 options defined in <xref
          target="RFC7598"></xref>.</t>

          <t>"Mapping of Address and Port using Translation (MAP-T)" <xref
          target="RFC7599"></xref> (DHCPv6 options defined in <xref
          target="RFC7598"></xref>.</t>

          <t>"Lightweight 4over6: An Extension to the Dual-Stack Lite
          Architecture" <xref target="RFC7596"></xref> (DHCPv6 options defined
          in <xref target="RFC7598"></xref>.</t>

          <t>"Unified IPv4-in-IPv6 Softwire Customer Premises Equipment (CPE):
          A DHCPv6-Based Prioritization Mechanism" <xref
          target="RFC8026"></xref>.</t>

          <t>"Delivery of IPv4 Multicast Services to IPv4 Clients over an IPv6
          Multicast Network" <xref target="RFC8114"></xref> (DHCPv6 options
          defined in <xref target="RFC8115"></xref>.</t>
        </list></t>

      <t>The contents of the attributes defined in this document have a 1:1
      mapping into the fields of the various DHCPv6 options in <xref
      target="RFC7598"></xref>, <xref target="RFC8026"></xref>, and <xref
      target="RFC8115"></xref>. Table 1 shows how the DHCPv6 options map to
      the corresponding RADIUS attribute. For detailed mappings between each
      DHCPv6 option field and the corresponding RADIUS Attribute or field, see
      <xref target="tlv-field-map"></xref>.</t>

      <t><figure
          title="Table 1: Mapping between DHCPv6 Options and RADIUS Attributes">
          <artwork align="center"><![CDATA[+----------------------------+--------------------------------+
|        DHCPv6 Option       |        RADIUS Attribute        |
+----------------------------+--------------------------------+
|     OPTION_S46_RULE (89)   |        Softwire46-Rule         |
|     OPTION_S46_BR (90)     |         Softwire46-BR          |
|     OPTION_S46_DMR (91)    |        Softwire46-DMR          |
|   OPTION_S46_V4V6BIND (92) |      Softwire46-V4V6Bind       |
| OPTION_S46_PORTPARAMS (93) |     Softwire46-PORTPARAMS      |
|  OPTION_S46_PRIORITY (111) |  Softwire46-Priority Attribute |
|  OPTION_V6_PREFIX64 (113)  | Softwire46-Multicast Attribute |
+----------------------------+--------------------------------+
]]></artwork>
        </figure></t>

      <t>A RADIUS attribute for Dual-Stack Lite <xref target="RFC6333"></xref>
      is defined in <xref target="RFC6519"></xref>.</t>
    </section>

    <section title="Terminology">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in <xref
      target="RFC2119"></xref> <xref target="RFC8174"></xref> when, and only
      when, they appear in all capitals, as shown here.</t>

      <t>The reader should be familiar with the concepts and terms defined in
      <xref target="RFC7596"></xref>, <xref target="RFC7597"></xref>, <xref
      target="RFC7599"></xref>, and <xref target="RFC8026"></xref>.</t>

      <t>The terms "multicast Basic Bridging BroadBand" element (mB4) and
      "multicast Address Family Transition Router" element (mAFTR) are defined
      in <xref target="RFC8114"></xref>.</t>

      <t>Softwire46 (S46) is used throughout to denote any of the IPv4-in-IPv6
      softwire mechanisms listed above. Additionally, the following
      abbreviations are used within the document:<list style="symbols">
          <t>BMR: Basic Mapping Rule</t>

          <t>BNG: Broadband Network Gateway</t>

          <t>BR: Border Relay</t>

          <t>CE: Customer Edge</t>

          <t>DMR: Default Mapping Rule</t>

          <t>EA: Embedded Address</t>

          <t>FMR: Forwarding Mapping Rule</t>

          <t>PSID: Port Set Identifier</t>

          <t>TLV: Type, Length, Value</t>

          <t>MAP-E: Mapping of Address and Port with Encapsulation</t>

          <t>MAP-T: Mapping of Address and Port using Translation</t>
        </list></t>
    </section>

    <section title="New RADIUS Attributes">
      <t>This section defines the following attributes: <list style="numbers">
          <t>Softwire46-Configuration Attribute (<xref
          target="conf-attr"></xref>): <vspace blankLines="1" />This attribute
          carries the configuration information for MAP-E, MAP-T, and
          Lightweight 4over6. The configuration information for each
          Softwire46 mechanism is carried in the corresponding Softwire46
          attributes. Different attributes are required for each Softwire46
          mechanism.</t>

          <t>Softwire46-Priority Attribute (<xref
          target="s46-prio-attr"></xref>): <vspace blankLines="1" /> Depending
          on the deployment scenario, a client may support several different
          Softwire46 mechanisms and so request configuration for more than one
          Softwire46 mechanism at a time. The Softwire46-Priority Attribute
          contains information allowing the client to prioritize which
          mechanism to use, corresponding to OPTION_S46_PRIORITY defined in
          <xref target="RFC8026"></xref>.</t>

          <t>Softwire46-Multicast Attribute (<xref
          target="s46-mcast-attr"></xref>): <vspace blankLines="1" />This
          attribute conveys the IPv6 prefixes to be used in <xref
          target="RFC8114"></xref> to synthesize IPv4-embedded IPv6 addresses.
          The BNG uses the IPv6 prefixes returned in the RADIUS
          Softwire46-Multicast Attribute to populate the DHCPv6 PREFIX64
          Option <xref target="RFC8115"></xref>.</t>
        </list></t>

      <t>All of these attributes are allocated from the RADIUS "Extended Type"
      code space per <xref target="RFC6929"></xref>.</t>

      <t>All of these attribute designs follow <xref target="RFC6158"></xref>
      and <xref target="RFC6929"></xref>.</t>

      <t>This document adheres to <xref target="RFC8044"></xref> for defining
      the new RADIUS attributes.</t>

      <section anchor="conf-attr" title="Softwire46-Configuration Attribute">
        <t>This attribute is of type "tlv", as defined in the RADIUS Protocol
        Extensions <xref target="RFC6929"></xref>. It contains some
        sub-attributes, with the following requirements:</t>

        <t><list style="empty">
            <t>The Softwire46-Configuration Attribute MUST contain one or more
            of the following attributes: Softwire46-MAP-E, Softwire46-MAP-T,
            and/or Softwire46-Lightweight-4over6.</t>

            <t>The Softwire46-Configuration Attribute conveys the
            configuration information for MAP-E, MAP-T, or Lightweight 4over6.
            The BNG SHALL use the configuration information returned in the
            RADIUS attribute to populate the DHCPv6 Softwire46 Container
            Option defined in Section 5 of <xref target="RFC7598"></xref>.</t>

            <t>The Softwire46-Configuration Attribute MAY appear in an
            Access-Accept packet. It MAY also appear in an Access-Request
            packet to indicate a preferred Softwire46 configuration. However,
            the server is not required to honor such a preference.</t>

            <t>The Softwire46-Configuration Attribute MAY appear in a
            CoA-Request packet.</t>

            <t>The Softwire46-Configuration Attribute MAY appear in an
            Accounting-Request packet.</t>

            <t>The Softwire46-Configuration Attribute MUST NOT appear in any
            other RADIUS packet.</t>

            <t>The Softwire46-Configuration Attribute MUST only encapsulate
            one or more of the Softwire46 attributes defined in this
            document.</t>
          </list></t>

        <t>The Softwire46-Configuration Attribute is structured as
        follows:</t>

        <t><figure>
            <artwork><![CDATA[  Type
    241 (To be confirmed by IANA). 

  Length
    Indicates the total length, in bytes, of all fields of
    this attribute, including the Type, Length, Extended-Type, 
    and the entire length of the embedded attributes.

   Extended-Type
      TBD1

   Value
      Contains one or more of the following attributes. Each attribute
      type may appear at most once:

      Softwire46-MAP-E
         For configuring MAP-E clients. For the construction of
         this attribute, refer to Section 3.1.1.1.

      Softwire46-MAP-T
         For configuring MAP-T clients. For the construction of
         this attribute, refer to Section 3.1.1.2.

      Softwire46-Lightweight-4over6
         For configuring Lightweight 4over6 clients. For the
         construction of this attribute, refer to Section 3.1.1.3.
]]></artwork>
          </figure></t>

        <t>The Softwire46-Configuration Attribute is associated with the
        following identifier: 241.Extended-Type(TBD1).</t>

        <section anchor="s46-tlvs" title="Softwire46 Attributes">
          <t>The Softwire46 attributes can only be encapsulated in the
          Softwire46-Configuration Attribute. Depending on the deployment
          scenario, a client might request for more than one transition
          mechanism at a time. There MUST be at least one Softwire46 attribute
          encapsulated in one Softwire46-Configuration Attribute. There MUST
          be at most one instance of each type of Softwire46 attribute
          encapsulated in one Softwire46-Configuration Attribute.</t>

          <t>There are three types of Softwire46 attributes, namely:<list
              style="numbers">
              <t>Softwire46-MAP-E (<xref target="etlv"></xref>)</t>

              <t>Softwire46-MAP-T (<xref target="ttlv"></xref>)</t>

              <t>Softwire46-Lightweight 4over6 (<xref
              target="ltlv"></xref>)</t>
            </list>Each type of Softwire46 attribute contains a number of
          sub-attributes, defined in <xref
          target="s46-sub-tlv-format"></xref>. The hierarchy of the Softwire46
          attributes is shown in <xref target="Hierar"></xref>. <xref
          target="s46-sub-tlvs"></xref> describes which sub-attributes are
          mandatory, optional, or not permitted for each defined Softwire46
          attribute.</t>

          <figure anchor="Hierar" title="Softwire46 Attributes Hierarchy">
            <artwork><![CDATA[                                              
                                                /1.Rule-IPv6-Prefix  
S                      /                       |   
o  /                  | 1.Softwire46-Rule -----+ 2.Rule-IPv4-Prefix 
f | Softwire46-MAP-E--+                        |    
t |                   | 2.Softwire46-BR        | 3.EA Length   
w |                   |                         \   
i |                   |                               /1.PSID-Offset
r |                   |                              |    
e |                   | 3.Softwire46-PORTPARAMS -----+ 2.PSID-Len 
- |                    \                             |    
C |                                                  | 3.PSID  
o |                                                   \   
n |
f |                                             /1.Rule-IPv6-Prefix  
i |                    /                       |    
g |                   | 1.Softwire46-Rule------+ 2.Rule-IPv4-Prefix 
u | Softwire46-MAP-T--+                        |    
r |                   | 2.Softwire46-DMR       | 3.EA Length 
a |                   |                         \   
t |                   |                               /1.PSID-Offset
i |                   |                              |    
o |                   | 3.Softwire46-PORTPARAMS------+ 2.PSID-Len 
n |                    \                             |    
  |                                                  | 3.PSID
A |                                                   \  
t |                     
t |                                                 /1.IPv4-Address
r |                    /                           |   
i |                   | 1.Softwire46-V4V6Bind -----+ 2.Bind-IPv6-Prefix 
b | Softwire46-       |                             \   
u | Lightweight-4over6+ 2.Softwire46-BR               /1.PSID-Offset
t  \                  |                              |    
e                     | 3.Softwire46-PORTPARAMS  ----+ 2.PSID-Len 
                       \                             |    
                                                     | 3.PSID 
                                                      \  
]]></artwork>
          </figure>

          <section anchor="etlv" title="Softwire46-MAP-E Attribute">
            <t>Softwire46-MAP-E attribute is designed for carrying the
            configuration information for MAP-E. The structure of
            Softwire46-MAP-E is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
     1  

   TLV-Length
     Indicates the length of this attribute, including
     the TLV-Type, TLV-Length, and TLV-Value fields.

   TLV-Value
     Contains a set of sub-attributes, with the following requirements:

     It MUST contain Softwire46-Rule, defined in Section 3.1.3.1.

     It MUST contain Softwire46-BR, defined in Section 3.1.3.2.

     It MAY contain Softwire46-PORTPARAMS, defined in Section 3.1.3.5.
]]></artwork>
            </figure>
          </section>

          <section anchor="ttlv" title="Softwire46-MAP-T Attribute">
            <t>Softwire46-MAP-T attribute is designed for carrying the
            configuration information for MAP-T. The structure of
            Softwire46-MAP-T is shown below:</t>

            <figure>
              <artwork><![CDATA[  TLV-Type
     2 

  TLV-Length
     Indicates the length of this attribute, including
     the TLV-Type, TLV-Length, and TLV-Value fields.

  TLV-Value
     Contains a set of sub-attributes, with the following requirements:

     It MUST contain Softwire46-Rule, defined in Section 3.1.3.1.

     It MUST contain Softwire46-DMR, defined in Section 3.1.3.3.

     It MAY contain Softwire46-PORTPARAMS, defined in Section 3.1.3.5.
]]></artwork>
            </figure>
          </section>

          <section anchor="ltlv"
                   title="Softwire46-Lightweight-4over6 Attribute">
            <t>Softwire46-Lightweight-4over6 attribute is designed for
            carrying the configuration information for Lightweight 4over6. The
            structure of Softwire46-Lightweight-4over6 is shown below:</t>

            <figure>
              <artwork><![CDATA[  TLV-Type
     3 

  TLV-Length
     Indicates the length of this attribute, including
     the TLV-Type, TLV-Length, and TLV-Value fields.

  TLV-Value
     Contains a set of sub-attributes as follows:

     It MUST contain Softwire46-BR, defined in Section 3.1.3.2.

     It MUST contain Softwire46-V4V6Bind, defined in Section 3.1.3.4.

     It MAY contain Softwire46-PORTPARAMS, defined in Section 3.1.3.5.
     ]]></artwork>
            </figure>
          </section>
        </section>

        <section anchor="s46-sub-tlvs" title="Softwire46 Sub-Attributes">
          <t>Table 2 shows which encapsulated sub-attributes are mandatory,
          optional, or not permitted for each defined Softwire46
          attribute.</t>

          <figure title="Table 2: Softwire46 Sub-Attributes">
            <artwork><![CDATA[+-----------------------+-------+-------+--------------------+
| Sub-Attributes        | MAP-E | MAP-T | Lightweight 4over6 |
+-----------------------+-------+-------+--------------------+
| Softwire46-BR         |   1   |   0   |          1         |
| Softwire46-Rule       |   1   |   1   |          0         |
| Softwire46-DMR        |   0   |   1   |          0         |
| Softwire46-V4V6Bind   |   0   |   0   |          1         |
| Softwire46-PORTPARAMS |  0-1  |  0-1  |         0-1        |
+-----------------------+-------+-------+--------------------+

]]></artwork>
          </figure>

          <t>The following table defines the meaning of Table 2 entries.</t>

          <t><figure>
              <artwork><![CDATA[0     Not Permitted
0-1   Optional, zero or one instance of the attribute
      may be present. 
1     Mandatory, only one instance of the attribute
      must be present.
]]></artwork>
            </figure></t>
        </section>

        <section anchor="s46-sub-tlv-format"
                 title="Specification of the Softwire46 Sub-Attributes">
          <section anchor="s46-rule-sub-tlv" title="Softwire46-Rule Attribute">
            <t>Softwire46-Rule can only be encapsulated in Softwire46-MAP-E
            (<xref target="etlv"></xref>) or Softwire46-MAP-T (<xref
            target="ttlv"></xref>). Depending on the deployment scenario, one
            Basic Mapping Rule (BMR) and zero or more Forwarding Mapping Rules
            (FMRs) MUST be included in one Softwire46-MAP-E or
            Softwire46-MAP-T.</t>

            <t>Each type of Softwire46-Rule also contains a number of
            sub-attributes, including Rule-IPv6-Prefix, Rule-IPv4-Prefix, and
            EA-Length. The structure of the sub-attributes for Softwire46-Rule
            is defined in <xref target="s46-rule-sub-tlvs"></xref>.</t>

            <t>Defining multiple TLV-types achieves the same design goals as
            the "Softwire46 Rule Flags" defined in Section 4.1 of <xref
            target="RFC7598"></xref>. Using TLV-type set to 5 is equivalent to
            setting the F-flag in the OPTION_S46_RULE S46 Rule Flags
            field.</t>

            <figure>
              <artwork><![CDATA[  TLV-Type
     4 Basic Mapping Rule only (not to be used for forwarding)
     5 Forwarding Permitted Mapping Rule

  TLV-Length
     Indicates the length of this attribute, including
     the TLV-Type, TLV-Length, and TLV-Value fields.

  Data Type
     The attribute Softwire46-Rule is of type tlv (Section 3.13 of
     [RFC8044]).

  TLV-Value
     This field contains a set of attributes as follows:

     Rule-IPv6-Prefix
        This attribute contains the IPv6 prefix for use in the MAP rule.
        Refer to Section 3.1.4.1.

     Rule-IPv4-Prefix
        This attribute contains the IPv4 prefix for use in the MAP rule.
        Refer to Section 3.1.4.2.

     EA-Length
        This attribute contains the Embedded-Address (EA) bit length.
        Refer to Section 3.1.4.3.
]]></artwork>
            </figure>
          </section>

          <section anchor="s46br" title="Softwire46-BR Attribute">
            <t>Softwire46-BR can only be encapsulated in Softwire46-MAP-E
            (<xref target="etlv"></xref>) or Softwire46-Lightweight-4over6
            (<xref target="ltlv"></xref>).</t>

            <t>There MUST be at least one Softwire46-BR included in each
            Softwire46-MAP-E or Softwire46-Lightweight-4over6.</t>

            <t>The structure of Softwire46-BR is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
      6

   TLV-Length
      18 octets

   Data Type
      The attribute Softwire46-BR is of type ip6addr (Section 3.9 of
      [RFC8044]).

   TLV-Value
      br-ipv6-address. A fixed-length field of 16 octets that 
      specifies the IPv6 address for the Softwire46 Border Relay (BR).]]></artwork>
            </figure>
          </section>

          <section anchor="s46dmr" title="Softwire46-DMR Attribute">
            <t>Softwire46-DMR may only appear in Softwire46-MAP-T (<xref
            target="ttlv"></xref>). There MUST be exactly one Softwire46-DMR
            included in one Softwire46-MAP-T.</t>

            <t>The structure of Softwire46-DMR is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
      7

   TLV-Length
      4 + length of dmr-ipv6-prefix specified in octets.

   Data Type
      The attribute Softwire46-DMR is of type ip6pref (Section 3.10 of
      [RFC8044]).

   TLV-Value
      dmr-ipv6-prefix. A variable-length (dmr-prefix6-len) field 
      specifying the IPv6 prefix for the BR. This field is right-padded
      with zeros to the nearest octet boundary when dmr-prefix6-len 
      is not divisible by 8. Prefixes with from 0 to 96 are allowed.
]]></artwork>
            </figure>
          </section>

          <section anchor="s46bind" title="Softwire46-V4V6Bind Attribute">
            <t>Softwire46-V4V6Bind may only be encapsulated in
            Softwire46-Lightweight-4over6 (<xref target="ltlv"></xref>). There
            MUST be exactly one Softwire46-V4V6Bind included in each
            Softwire46-Lightweight-4over6.</t>

            <t>The structure of Softwire46-V4V6Bind is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
      8

   TLV-Length
      Indicates the length of this attribute, including
      the TLV-Type, TLV-Length, and TLV-Value fields.

   Data Type
      The attribute Softwire46-V4V6Bind is of type tlv (Section 3.13 of
      [RFC8044]).

   TLV-Value
      This field contains a set of attributes as follows:

      IPv4-Address
         This attribute contains an IPv4 address, used to specify 
         the full or shared IPv4 address of the CE. Refer to 
         Section 3.1.5.1.

      Bind-IPv6-Prefix
         This attribute contains an IPv6 prefix used to indicate which 
         configured prefix the Softwire46 CE should use for constructing
         the softwire. Refer to Section 3.1.5.2.
 ]]></artwork>
            </figure>
          </section>

          <section anchor="s46param" title="Softwire46-PORTPARAMS Attribute">
            <t>Softwire46-PORTPARAMS is optional. It is used to specify port
            set information for IPv4 address sharing between clients.
            Softwire46-PORTPARAMS MAY be included in any of the Softwire46
            attributes.</t>

            <t>The structure of Softwire46-PORTPARAMS is shown below:</t>

            <figure>
              <artwork><![CDATA[ 
   TLV-Type
      9

   TLV-Length
      Indicates the length of this attribute, including
      the TLV-Type, TLV-Length, and TLV-Value fields.

   Data Type
      The attribute Softwire46-PORTPARAMS is of type tlv (Section 3.13 
      of [RFC8044]).

   TLV-Value
      This field contains a set of attributes as follows:

      PSID-Offset
         This attribute specifies the numeric value for the Softwire46
         algorithm's excluded port range/offset bits (a bits). Refer to 
         Section 3.1.6.1.

      PSID-Len 
         This attribute specifies the number of significant bits in the
         PSID field (also known as 'k'). Refer to Section 3.1.6.2.

      PSID 
         This attribute specifies PSID value. Refer to Section 3.1.6.3.
]]></artwork>
            </figure>
          </section>
        </section>

        <section anchor="s46-rule-sub-tlvs"
                 title="Sub-Attributes for Sofwtire46-Rule">
          <t>There are two types of Softwire46-Rule: the Basic Mapping Rule
          and the Forwarding Mapping Rule, indicated by the value in the
          TLV-Type field of Softwire46-Rule (<xref
          target="s46-rule-sub-tlv"></xref>).</t>

          <t>Each type of Softwire46-Rule also contains a number of
          Sub-attributes as detailed in the following sub-sections.</t>

          <section title="Rule-IPv6-Prefix Attribute">
            <t>Rule-IPv6-Prefix is REQUIRED for every Softwire46-Rule. There
            MUST be exactly one Rule-IPv6-Prefix encapsulated in each type of
            Softwire46-Rule.</t>

            <t>Rule-IPv6-Prefix follows the framed IPv6 prefix designed in
            <xref target="RFC3162"></xref> and <xref
            target="RFC8044"></xref>.</t>

            <t>The structure of Rule-IPv6-Prefix is shown below:</t>

            <t><figure>
                <artwork><![CDATA[   TLV-Type
      10

   TLV-Length 
      4 + length of rule-ipv6-prefix specified in octets.

   Data Type
      The attribute Rule-IPv6-Prefix is of type ipv6pref (Section 3.10 
      of [RFC8044]).

   TLV-Value
      rule-ipv6-prefix. A variable-length field that specifies an IPv6 
      prefix appearing in the MAP rule.
]]></artwork>
              </figure></t>
          </section>

          <section title="Rule-IPv4-Prefix Attribute">
            <t>This attribute is used to convey the MAP Rule IPv4 prefix. The
            structure of Rule-IPv4-Prefix is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
      11 

   TLV-Length 
      4 + length of rule-ipv4-prefix specified in octets.

   Data Type
      The attribute Rule-IPv4-Prefix is of type ipv4pref (Section 3.11
      of [RFC8044]).

   TLV-Value
      rule-ipv4-prefix. A variable-length field that pecifies  
      an IPv4 prefix appearing in the MAP rule.
]]></artwork>
            </figure>
          </section>

          <section title="EA-Length Attribute">
            <t>This attribute is used to convey the Embedded-Address (EA) bit
            length. The structure of EA-Length is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type 
      12

   TLV-Length 
      6 octets

   Data Type
      The attribute EA-Length is of type integer (Section 3.1 of
      [RFC8044]).

  TLV-Value
      EA-len; 32-bits long. Specifies the Embedded-Address (EA) bit 
      length. Allowed values range from 0 to 48.]]></artwork>
            </figure>
          </section>
        </section>

        <section title="Attributes for Softwire46-v4v6Bind">
          <section title="IPv4-Address Attribute">
            <t>The IPv4-Address MAY be used to specify the full or shared IPv4
            address of the CE.</t>

            <t>The structure of IPv4-Address is shown below:</t>

            <t><figure>
                <artwork><![CDATA[
   TLV-Type
      13

   TLV-Length  
      6 octets 

   Data Type
      The attribute IPv4-Address is of type ipv4addr (Section 3.8 
      of [RFC8044]).

   TLV-Value
      32-bits long. Specifies the IPv4 address (ipv4-address) to 
      appear in Softwire46-V4V6Bind (Section 3.1.3.4).]]></artwork>
              </figure></t>
          </section>

          <section title="Bind-IPv6-Prefix Attribute">
            <t>The Bind-IPv6-Prefix is used by the CE to identify the correct
            IPv6 prefix to be used as the tunnel source.</t>

            <t>The structure of Bind-IPv6-Prefix is shown below:</t>

            <figure>
              <artwork><![CDATA[   TLV-Type
      14

   TLV-Length
      4 + length of bind-ipv6-prefix specified in octets.

   Data Type
      The attribute Bind-IPv6-Prefix is of type ipv6pref (Section 3.10 
      of [RFC8044]).

   TLV-Value 
      bind-ipv6-prefix. A variable-length field specifying the IPv6 
      prefix or address for the Softwire46 CE. This field is 
      right-padded with zeros to the nearest octet boundary
      when bindprefix6-len is not divisible by 8.]]></artwork>
            </figure>
          </section>
        </section>

        <section title="Attributes for S46-PORTPARAMS">
          <section title="PSID-Offset Attribute">
            <t>This attribute is used to convey the Port Set Identifier offset
            as defined in <xref target="RFC7597"></xref>. This attribute is
            encoded 32 bits as per the recommendation in Appendix A.2.1 of
            <xref target="RFC6158"></xref>.</t>

            <t>The structure of PSID-Offset is shown below:</t>

            <t><figure>
                <artwork><![CDATA[   TLV-Type
      15

   TLV-Length 
      6 octets 

   Data Type
      The attribute PSID-Offset is of type integer (Section 3.1 
      of [RFC8044]).

   TLV-Value 
      Contains the PSID-Offset (8-bits) right
      justified, and the unused bits in this field MUST
      be set to zero. This field that specifies the
      numeric value for the Softwire46 algorithm's excluded 
      port range/offset bits (a bits), as per Section 5.1 
      of [RFC7597]. Allowed values are between 0 and 15. 
      Default values for this field are specific to the 
      Softwire mechanism being implemented and are defined 
      in the relevant specification document.]]></artwork>
              </figure></t>
          </section>

          <section title="PSID-Len Attribute">
            <t>This attribute is used to convey the PSID length as defined in
            <xref target="RFC7597"></xref>. This attribute is encoded 32 bits
            as per the recommendation in Appendix A.2.1 of <xref
            target="RFC6158"></xref>.</t>

            <t>The structure of PSID-Len is shown below:</t>

            <t><figure>
                <artwork><![CDATA[   TLV-Type
      16

   TLV-Length
      6 octets

   Data Type
      The attribute PSID-Len is of type integer (Section 3.1
      of [RFC8044]).

   TLV-Value 
      Contains the PSID-len (8-bits) right
      justified, and the unused bits in this field MUST
      be set to zero. This field specifies the number of 
      significant bits in the PSID field (also known as
      'k'). When set to 0, the PSID field is to be ignored.
      After the first 'a' bits, there are k bits in the
      port number representing the value of the PSID.
      Subsequently, the address sharing ratio would be 
      2^k.]]></artwork>
              </figure></t>
          </section>

          <section title="PSID Attribute">
            <t>This attribute is used to convey the PSID as defined in <xref
            target="RFC7597"></xref>. This attribute is encoded 32 bits as per
            the recommendation in Appendix A.2.1 of <xref
            target="RFC6158"></xref>.</t>

            <t>The structure of PSID is shown below:</t>

            <t><figure>
                <artwork><![CDATA[   TLV-Type
      17

   TLV-Length 
      6 octets

   Data Type
      The attribute PSID is of type integer (Section 3.1 
      of [RFC8044]).

   TLV-Value 
      Contains the PSID (16-bits) right justified, and the unused bits 
      in this field MUST be set to zero. 
      The PSID value algorithmically identifies a set of ports 
      assigned to a CE. The first k bits on the left of this 
      2-octet field is the PSID value. The remaining (16-k) bits 
      on the right are padding zeros.]]></artwork>
              </figure></t>
          </section>
        </section>
      </section>

      <section anchor="s46-prio-attr" title="Softwire46-Priority Attribute">
        <t>The Softwire46-Priority Attribute includes an ordered list of
        Softwire64 mechanisms allowing the client to prioritize which
        mechanism to use, corresponding to OPTION_S46_PRIORITY defined in
        <xref target="RFC8026"></xref>. The following requirements apply:</t>

        <t><list style="empty">
            <t>The Softwire46-Priority Attribute MAY appear in an
            Access-Accept packet. It MAY also appear in an Access-Request
            packet.</t>

            <t>The Softwire46-Priority Attribute MAY appear in a CoA-Request
            packet.</t>

            <t>The Softwire46-Priority Attribute MAY appear in an
            Accounting-Request packet.</t>

            <t>The Softwire46-Priority Attribute MUST NOT appear in any other
            RADIUS packet.</t>
          </list></t>

        <t>The Softwrie46-Priority Attribute is structured as follows:<figure>
            <artwork><![CDATA[   Type
     241 (To be confirmed by IANA)

   Length
     Indicates the length of this attribute, 
     including the Type, Length, Extended-Type and Value fields.

   Extended-Type
     TBD5

   TLV-Value
    The attribute includes one or more Softwire46-Option-Code TLVs:
       A Softwire46-Priority Attribute MUST contain at least one 
       Softwire46-Option-Code TLV (Section 3.2.1).

       Softwire46 mechanisms are prioritized in the appearance order
       of the in the Softwire46-Priority Attribute. 
]]></artwork>
          </figure></t>

        <t>The Softwire46-Priority Attribute is associated with the following
        identifier: 241.Extended-Type (TBD5).</t>

        <section anchor="opc" title="Softwire46-Option-Code">
          <t>This attribute is used to convey an option code assigned to a
          Softwire64 mechanism <xref target="RFC8026"></xref>. This attribute
          is encoded 32 bits as per the recommendation in Appendix A.2.1 of
          <xref target="RFC6158"></xref>.</t>

          <t>The structure of Softwire46-Option-Code is shown below:</t>

          <t><figure>
              <artwork><![CDATA[   TLV-Type
      18

   TLV-Length 
      6 octets

   Data Type
      The attribute Softwire46-Option-Code is of type integer
     (Section 3.1 of [RFC8044]).

   TLV-Value 
      A 32-bit IANA-registered option code representing a Softwire46
      mechanism (Softwire46-option-code). The codes and their 
      corresponding Softwire46 mechanisms are listed in Section 7.3.]]></artwork>
            </figure></t>

          <t></t>
        </section>
      </section>

      <section anchor="s46-mcast-attr" title="Softwire46-Multicast Attribute">
        <t>The Softwire46-Multicast Attribute conveys the IPv6 prefixes to be
        used to synthesize multicast and unicast IPv4-embedded IPv6 addresses
        as per <xref target="RFC8114"></xref>. This attribute is of type "tlv"
        and contains additional TLVs. The following requirements apply:</t>

        <t><list style="empty">
            <t>The BNG SHALL use the IPv6 prefixes returned in the RADIUS
            Softwire46-Multicast Attribute to populate the DHCPv6 PREFIX64
            Option <xref target="RFC8115"></xref>.</t>

            <t>This attribute MAY be used in Access-Request packets as a hint
            to the RADIUS server. For example, if the BNG is pre-configured
            for Softwire46-Multicast, these prefixes may be inserted in the
            attribute. The RADIUS server MAY ignore the hint sent by the BNG,
            and it MAY assign a different Softwire46-Multicast Attribute.</t>

            <t>The Softwire46-Multicast Attribute MAY appear in an
            Access-Request, Access-Accept, CoA-Request, and Accounting-Request
            packet.</t>

            <t>The Softwire46-Multicast Attribute MUST NOT appear in any other
            RADIUS packet.</t>

            <t>The Softwire46-Multicast Attribute MAY contain ASM-Prefix64
            (<xref target="TLV0"></xref>), SSM-Prefix64 (<xref
            target="TLV1"></xref>), and U-Prefix64 (<xref
            target="TLV2"></xref>).</t>

            <t>The Softwire46-Multicast Attribute MUST include ASM-Prefix64 or
            SSM-Prefix64, and it MAY include both.</t>

            <t>The U-Prefix64 MUST be present when SSM-Prefix64 is present.
            U-Prefix64 MAY be present when ASM-Prefix64 is present.</t>
          </list></t>

        <t>The Softwire46-Multicast Attribute is structured as follows:</t>

        <figure>
          <artwork><![CDATA[
   Type
     241 (To be confirmed by IANA)

   Length
     This field indicates the total length in bytes of all fields of
     this attribute, including the Type, Length, Extended-Type, and the
     entire length of the embedded attributes.

   Extended-Type
     TBD6

   Value
     This field contains a set of attributes as follows:

     ASM-Prefix64
       This attribute contains the ASM IPv6 prefix. Refer to 
       Section 3.3.1.

     SSM-Prefix64
       This attribute contains the SSM IPv6 prefix. Refer to 
       Section 3.3.2.

     U-Prefix64
       This attribute contains the IPv4 prefix used for address
       translation. Refer to Section 3.3.3.
      ]]></artwork>
        </figure>

        <t>The Softwire46-Multicast Attribute is associated with the following
        identifier: 241.Extended-Type(TBD6).</t>

        <section anchor="TLV0" title="ASM-Prefix64 Attribute">
          <t>The ASM-Prefix64 attribute is structured as follows:</t>

          <figure>
            <preamble></preamble>

            <artwork><![CDATA[
   TLV-Type
      19
  
   TLV-Length
      16 octets. The length of ssm-prefix64 must be to 96 [RFC8115].

   Data Type
      The attribute ASM-Prefix64 is of type ipv6prefix (Section 3.10 of
      [RFC8044]).

   TLV-Value
      This field specifies the IPv6 multicast prefix (asm-prefix64)
      to be used to synthesize the IPv4-embedded IPv6 addresses of the
      multicast groups in the ASM mode. The conveyed multicast IPv6
      prefix MUST belong to the ASM range. 
      ]]></artwork>
          </figure>
        </section>

        <section anchor="TLV1" title="SSM-Prefix64 Attribute">
          <t>The SSM-Prefix64 attribute is structured as follows:</t>

          <figure>
            <artwork><![CDATA[   Type
     20

   TLV-Length
      16 octets. The length of ssm-prefix64 must be to 96 [RFC8115].

   Data Type
      The attribute SSM-Prefix64 is of type ipv6prefix (Section 3.10 of
      [RFC8044]).

   TLV-Type
      This field specifies the IPv6 multicast prefix (ssm-prefix64)
      to be used to synthesize the IPv4-embedded IPv6 addresses of the
      multicast groups in the SSM mode. The conveyed multicast IPv6
      prefix MUST belong to the SSM range. 
      ]]></artwork>
          </figure>
        </section>

        <section anchor="TLV2" title="U-Prefix64 Attribute">
          <t>The structure of U-Prefix64 is shown below:</t>

          <figure>
            <preamble></preamble>

            <artwork><![CDATA[
   TLV-Type
      21

   TLV-Length
      4 + length of unicast-prefix. As specified in [RFC6052], 
      the unicast-prefix prefix-length MUST be set to 32, 40, 48,
      56, 64, or 96.
   
   Data Type
      The attribute U-Prefix64 is of type ipv6prefix (Section 3.10 of
      [RFC8044]).
   
   TLV-Value
      This field identifies the IPv6 unicast prefix (u-prefix64) to
      be used in SSM mode for constructing the IPv4-embedded IPv6
      addresses representing the IPv4 multicast sources in the IPv6
      domain. It may also be used to extract the IPv4 address from the
      received multicast data flows.      ]]></artwork>
          </figure>
        </section>
      </section>
    </section>

    <section title="A Sample Configuration Process with RADIUS">
      <t><xref target="example"></xref> illustrates how the RADIUS and DHCPv6
      protocols interwork to provide CE with softwire configuration
      information.</t>

      <figure align="center" anchor="example"
              title="Interaction between DHCPv6 and AAA       Server with RADIUS authentication">
        <artwork><![CDATA[ 
 CE                             BNG                         AAA Server
 |                               |                               |
 |-------1.DHCPv6 Solicit------->|                               |
 |(ORO with unicast and/or m'cast|                               |
 |    container option code(s))  |                               |
 |                               |                               |
 |                               |-------2.Access-Request------->|
 |                               |   (Softwire46-Configuration   |
 |                               |       Attribute and/or        |
 |                               |Softwire46-Multicast Attribute)|
 |                               |                               |
 |                               |<------3.Access-Accept---------|
 |                               |   (Softwire46-Configuration   |
 |                               |       Attribute and/or        |
 |                               |Softwire46-Multicast Attribute)|
 |                               |                               |
 |<----4.DHCPv6 Advertisement----|                               |
 |     (container option(s))     |                               |
 |                               |                               |
 |-------5.DHCPv6  Request------>|                               |
 |     (container Option(s))     |                               |
 |                               |                               |
 |<--------6.DHCPv6 Reply--------|                               |
 |     (container option(s))     |                               |
 |                               |                               |
              DHCPv6                         RADIUS

]]></artwork>
      </figure>

      <t><list style="numbers">
          <t>The CE creates a DHCPv6 Solicit message. For unicast softwire
          configuration, the message includes an OPTION_REQUEST_OPTION (6)
          with the Softwire46 Container option codes as defined in <xref
          target="RFC7598"></xref>. OPTION_S46_CONT_MAPE (94) should be
          included for MAP-E, OPTION_S46_CONT_MAPT (95) for MAP-T, and
          OPTION_S46_CONT_LW (96) for Lightweight 4over6. For multicast
          configuration, the option number for OPTION_V6_PREFIX64 (113) is
          included in the client's ORO. The message is sent to the BNG.</t>

          <t>On receipt of the Solicit message, the BNG constructs a RADIUS
          Access-Request message containing a User-Name Attribute (1)
          (containing either a CE MAC address, interface-id or both), a
          User-Password Attribute (2) (with a pre-configured shared password
          as defined in <xref target="RFC2865"></xref>. The
          Softwire46-Configuration Attribute and/or Softwire46-Multicast
          Attribute are also included (as requested by the client). The
          resulting message is sent to the AAA server.</t>

          <t>The AAA server authenticates the request. If this is successful,
          and suitable configuration is available, an Access-Accept message is
          sent to the BNG containing the requested Softwire46-Configuration
          Attribute or Softwire46-Multicast Attribute. It is the
          responsibility of the AAA server to ensure the consistency of the
          provided configuration.</t>

          <t>The BNG maps the received softwire configuration into the
          corresponding fields in the DHCPv6 softwire configuration option(s).
          These are included in the DHCPv6 Advertise message which is sent to
          the CE.</t>

          <t>The CE sends a DHCPv6 Request message. In the ORO, the option
          code(s) of any of the required softwire options that were received
          in the Advertise message are included.</t>

          <t>The BNG sends a Reply message to the client containing the
          softwire container options enumerated in the ORO.</t>
        </list></t>

      <t>The authorization operation could also be done independently, after
      the authentication process. In this case, steps 1-5 are completed as
      above, then the following steps are performed:</t>

      <t><list hangIndent="4" style="hanging">
          <t hangText="6a.">When the BNG receives the DHCPv6 Request, it
          constructs a RADIUS Access-Request message, which contains a
          Service-Type Attribute (6) with the value "Authorize Only" (17), the
          corresponding Softwire46-Configuration Attribute, and a State
          Attribute obtained from the previous authentication process
          according to <xref target="RFC5080"></xref>. The resulting message
          is sent to the AAA server.</t>

          <t hangText="7a.">The AAA checks the authorization request. If it is
          approved, an Access-Accept message is returned to the BNG with the
          corresponding Softwire46-Configuration Attribute.</t>

          <t hangText="8a.">The BNG sends a Reply message to the client
          containing the softwire container options enumerated in the ORO.</t>
        </list></t>

      <t>In addition to the above, the following points need to be
      considered:</t>

      <t><list style="symbols">
          <t>In both the configuration message flows described above the
          Message-authenticator (type 80) <xref target="RFC2869"></xref>
          SHOULD be used to protect both Access-Request and Access-Accept
          messages.</t>

          <t>If the BNG does not receive the corresponding
          Softwire46-Configuration Attribute in the Access-Accept message it
          MAY fall back to creating the DHCPv6 softwire configuration options
          using pre-configured Softwire46 configuration, if this is
          present.</t>

          <t>If the BNG receives an Access-Reject from the AAA server, then
          Softwire46 configuration MUST NOT be supplied to the client.</t>

          <t>As specified in <xref target="RFC8415"></xref>, Section 18.2.5,
          "Creation and Transmission of Rebind Messages", if the DHCPv6 server
          to which the DHCPv6 Renew message was sent at time T1 has not
          responded by time T2, the CE (DHCPv6 client) SHOULD enter the Rebind
          state and attempt to contact any available server. In this
          situation, a secondary BNG receiving the DHCPv6 message MUST
          initiate a new Access-Request message towards the AAA server. The
          secondary BNG includes the Softwire46-Configuration Attribute in
          this Access-Request message.</t>

          <t>For Lightweight 4over6, the subscriber's binding state needs to
          be synchronized between the clients and the lwAFTR/BR. This can be
          achieved in two ways: static pre-configuration of the bindings on
          both the AAA server and lwAFTR, or on-demand whereby the AAA server
          updates the lwAFTR with the subscriber's binding state as it is
          created or deleted.</t>
        </list></t>

      <t>In some deployments, the DHCP server may use the Accounting-Request
      to report to a AAA server the softwire configuration returned to a
      requesting host. It is the responsibility of the DHCP server to ensure
      the consistency of the configuration provided to requesting hosts.
      Reported data to a AAA server may be required for various operational
      purposes (e.g., regulatory).</t>
    </section>

    <section title="Table of Attributes">
      <t>This document specifies three new RADIUS attributes, and their
      formats are as follows:</t>

      <t><list style="symbols">
          <t>Softwire46-Configuration Attribute: 241.TBD1</t>

          <t>Softwire46-Priority Attribute: 241.TBD5</t>

          <t>Softwire46-Multicast Attribute: 241.TBD6</t>
        </list></t>

      <t>Table 3 describes which attributes may be found, in which kinds of
      packets and in what quantity.</t>

      <t><figure title="Table 3: Table of Attributes">
          <artwork><![CDATA[Request Accept Reject Challenge Acct CoA-  #       Attribute
                                Req  Req
 0-1     0-1     0      0       0-1  0-1  241.TBD1 Softwire46-
                                                   Configuration
 0-1     0-1     0      0       0-1  0-1  241.TBD5 Softwire46-
                                                   Priority
 0-1     0-1     0      0       0-1  0-1  241.TBD6 Softwire46-
                                                   Multicast
]]></artwork>
        </figure></t>

      <t></t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>Known security vulnerabilities of the RADIUS protocol are discussed
      in <xref target="RFC2607"></xref>, <xref target="RFC2865"></xref>,
      and<xref target="RFC2869"></xref>. Use of IPsec <xref
      target="RFC4301"></xref> for providing security when RADIUS is carried
      in IPv6 is discussed in <xref target="RFC3162"></xref>.</t>

      <t>Specific security considerations for interactions between the MAP CE
      and the BNG are discussed in <xref target="RFC7597"></xref> and <xref
      target="RFC7599"></xref>. Security considerations for Lightweight 4over6
      are discussed in <xref target="RFC7596"></xref>. Security considerations
      for DHCPv6-Based Softwire46 Prioritization Mechanism are discussed in
      <xref target="RFC8026"></xref>. Security considerations for multicast
      scenarios are discussed in <xref target="RFC8114"></xref>. Furthermore,
      generic DHCPv6 security mechanisms can be applied to DHCPv6
      intercommunication between the CE and the BNG.</t>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>IANA is requested to make new code point assignments for RADIUS
      attributes as described in the following subsections.</t>

      <section title="New RADIUS Attributes">
        <t>This document requests IANA to assign the Attribute Types defined
        in this document from the RADIUS namespace as described in the "IANA
        Considerations" section of <xref target="RFC3575"></xref>, in
        accordance with BCP 26 <xref target="RFC8126"></xref>.</t>

        <t>This document requests that IANA register three new RADIUS
        attributes, from the "Short Extended Space" of <xref
        target="RFC6929"></xref>. The attributes are: Softwire46-Configuration
        Attribute, Softwire46-Priority Attribute, and Softwire46-Multicast
        Attribute:</t>

        <figure>
          <artwork><![CDATA[   Type        Description                Data Type   Reference
   ----        -----------                ---------   ---------
   241.TBD1     Softwire46-Configuration   tlv         Section 3.1 
   241.TBD5     Softwire46-Priority        tlv         Section 3.2
   241.TBD6     Softwire46-Multicast       tlv         Section 3.3]]></artwork>
        </figure>
      </section>

      <section title="RADIUS Softwire46 Configuration and Multicast Attributes">
        <t>IANA is requested to create a new registry called "RADIUS
        Softwire46 Configuration and Multicast Attributes".</t>

        <t>All attributes in this registry have one or more parent RADIUS
        attributes in nesting (refer to <xref target="RFC6929"></xref>).</t>

        <t>This registry must be initially populated with the following
        values:</t>

        <t><figure>
            <artwork><![CDATA[Value  Description                     Data Type    Reference
-----  -----------                     ---------    ---------
0      Reserved
1      Softwire46-MAP-E                tlv          Section 3.1.1.1
2      Softwire46-MAP-T                tlv          Section 3.1.1.2
3      Softwire46-Lightweight-4over6   tlv          Section 3.1.1.3 
4      Softwire46-Rule (BMR)           tlv          Section 3.1.3.1
5      Softwire46-Rule (FMR)           tlv          Section 3.1.3.1
6      Softwire46-BR                   ipv6addr     Section 3.1.3.2
7      Softwire46-DMR                  ipv6prefix   Section 3.1.3.3
8      Softwire46-V4V6Bind             tlv          Section 3.1.3.4
9      Softwire46-PORTPARAMS           tlv          Section 3.1.3.5
10     Rule-IPv6-Prefix                ipv6prefix   Section 3.1.4.1
11     Rule-IPv4-Prefix                ipv4prefix   Section 3.1.4.2
12     EA-Length                       integer      Section 3.1.4.3
13     IPv4-Address                    ipv4addr     Section 3.1.5.1
14     Bind-IPv6-Prefix                ipv6prefix   Section 3.1.5.2
15     PSID-Offset                     integer      Section 3.1.6.1
16     PSID-Len                        integer      Section 3.1.6.2
17     PSID                            integer      Section 3.1.6.3
18     Softwire64-Option-Code          integer      Section 3.2.1
19     ASM-Prefix64                    ipv6prefix   Section 3.3.1
20     SSM-Prefix64                    ipv6prefix   Section 3.3.2
21     U-Prefix64                      ipv6prefix   Section 3.3.3
22-255 Unassigned]]></artwork>
          </figure></t>

        <t>The registration procedure for this registry is Standards Action as
        defined in <xref target="RFC8126"></xref>.</t>
      </section>

      <section title="Softwire46 Mechanisms and Their Identifying Option Codes">
        <t>The Softwire46-Priority Attribute conveys an ordered list of option
        codes assigned to Softwire64 mechanisms, for which IANA is requested
        to create and maintain a new registry entitled "Option Codes Permitted
        in the Softwire46-Priority Attribute". </t>

        <t>The value of option code corresponds to the TLV-Type defined in
        <xref target="s46-tlvs"></xref>. Additional options may be added to
        this list in the future using the IETF Review process described in
        Section 4.8 of <xref target="RFC8126"></xref>.</t>

        <t>Table 4 shows the initial version of allowed option codes, and the
        Softwire46 mechanisms that they represent. The option code for DS-Lite
        is derived from the IANA allocated RADIUS Attribute Type value for
        DS-Lite <xref target="RFC6519"></xref>. The option codes for MAP-E,
        MAP-T, and Lightweight 4over6 need to be assigned. The option codes
        for MAP-E, MAP-T, and Lightweight 4over6 should also be used as the
        TLV-Type values for the MAP-E, MAP-T, and Lightweight 4over6
        attributes defined in <xref target="s46-tlvs"></xref>.</t>

        <figure title="Table 4: Option Codes to S46 Mechanisms">
          <artwork><![CDATA[          +-----------+--------------------+-----------+
          |Option Code|Softwire46 Mechanism| Reference |
          +-----------+--------------------+-----------+
          |    TBD2   |        MAP-E       |  RFC7597  |
          |    TBD3   |        MAP-T       |  RFC7599  |
          |    TBD4   | Lightweight 4over6 |  RFC7596  |
          |    144    |      DS-Lite       |  RFC6519  |
          +-----------+--------------------+-----------+
]]></artwork>
        </figure>
      </section>
    </section>

    <section title="Contributing Authors">
      <figure>
        <artwork><![CDATA[Bing Liu
Huawei Technologies Co., Ltd
Q14, Huawei Campus, No.156 Beiqing Road
Hai-Dian District, Beijing, 100095
P.R. China

Email: leo.liubing@huawei.com

Peter Deacon
IEA Software, Inc.
P.O. Box 1170
Veradale, WA  99037
USA

Email: peterd@iea-software.com

Chongfeng Xie
China Telecom
Beijing
P.R. China

Email: xiechf.bri@chinatelecom.cn

Tianxiang Li
Tsinghua University
Beijing  100084
P.R.China

Email: peter416733@gmail.com

Qiong Sun
China Telecom
Beijing  China

Email: sunqiong@ctbri.com.cn

Qi Sun
Tsinghua University
Department of Computer Science, Tsinghua University
Beijing 100084
P.R.China
Phone: +86-10-6278-5822
   
Email: sunqibupt@gmail.com

Cathy Zhou
Huawei Technologies
Bantian, Longgang District
Shenzhen 518129
   
Email: cathy.zhou@huawei.com

Tina Tsou
Huawei Technologies(USA)
2330 Central Expressway
Santa Clara, CA 95050
USA

Email: Tina.Tsou.Zouting@huawei.com

ZiLong Liu
Tsinghua University
Beijing 100084
P.R.China
Phone: +86-10-6278-5822

Email: liuzilong8266@126.com

Yong Cui
Tsinghua University
Beijing 100084
P.R.China
Phone: +86-10-62603059

Email: yong@csnet1.cs.tsinghua.edu.cn    ]]></artwork>
      </figure>
    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The authors would like to thank the valuable comments made by Peter
      Lothberg, Wojciech Dec, Ian Farrer, Suresh Krishnan, Qian Wang, Wei
      Meng, Cui Wang, Alan Dekok, Stefan Winter, and Yu Tianpeng to this
      document.</t>

      <t>This document was merged with draft-sun-softwire-lw4over6-radext-01
      and draft-wang-radext-multicast-radius-ext-00, thanks to everyone who
      contributed to this document.</t>

      <t>This document was produced using the xml2rfc tool <xref
      target="RFC7991"></xref>.</t>

      <t>Many thanks to Al Morton, Bernie Volz, and Joel Halpern for the
      review.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include='reference.RFC.2119'?>

      <?rfc include='reference.RFC.2865'?>

      <?rfc include='reference.RFC.3162'?>

      <?rfc include='reference.RFC.8415'?>

      <?rfc include='reference.RFC.3575'?>

      <?rfc include='reference.RFC.5080'?>

      <?rfc include='reference.RFC.8126'?>

      <?rfc include='reference.RFC.6052'?>

      <?rfc include='reference.RFC.6158'?>

      <?rfc include='reference.RFC.6929'?>

      <?rfc include='reference.RFC.8026'?>

      <?rfc include='reference.RFC.8044'?>

      <?rfc include='reference.RFC.8114'?>

      <?rfc include='reference.RFC.8115'?>

      <?rfc include='reference.RFC.8174'?>
    </references>

    <references title="Informative References">
      <?rfc include='reference.RFC.2869'?>

      <?rfc include='reference.RFC.7596'?>

      <?rfc include='reference.RFC.7597'?>

      <?rfc include='reference.RFC.7598'?>

      <?rfc include='reference.RFC.7599'?>

      <?rfc include='reference.RFC.2607'?>

      <?rfc include='reference.RFC.7991'?>

      <?rfc include='reference.RFC.4301'?>

      <?rfc include='reference.RFC.6346'?>

      <?rfc include='reference.RFC.6333'?>

      <?rfc include='reference.RFC.6519'?>
    </references>

    <section anchor="tlv-field-map" title="DHCPv6 to RADIUS Field Mappings">
      <t>The following sections detail the mappings between the softwire
      DHCPv6 option fields and the relevant RADIUS attributes as defined in
      this document.</t>

      <section title="OPTION_S46_RULE (89) to Softwire46-Rule Sub-TLV Field Mappings">
        <t></t>

        <texttable>
          <ttcol align="center">OPTION_S46_RULE Field</ttcol>

          <ttcol align="center">Softwire46-Rule Name</ttcol>

          <ttcol align="center">TLV Subfield</ttcol>

          <c>flags</c>

          <c>N/A</c>

          <c>TLV-type (TBD7, TBD8)</c>

          <c>ea-len</c>

          <c>EA-Length</c>

          <c>EA-len</c>

          <c>prefix4-len</c>

          <c>Rule-IPv4-Prefix</c>

          <c>Prefix-Length</c>

          <c>ipv4-prefix</c>

          <c>Rule-IPv4-Prefix</c>

          <c>rule-ipv4-prefix</c>

          <c>prefix6-len</c>

          <c>Rule-IPv6-Prefix</c>

          <c>Prefix-Length</c>

          <c>ipv6-prefix</c>

          <c>Rule-IPv6-Prefix</c>

          <c>rule-ipv6-prefix</c>
        </texttable>
      </section>

      <section title="OPTION_S46_BR (90) to Softwire46-BR Field Mappings">
        <texttable>
          <ttcol align="center">OPTION_S46_BR Field</ttcol>

          <ttcol align="center">Softwire46-BR Subfield</ttcol>

          <c>br-ipv6-address</c>

          <c>br-ipv6-address</c>
        </texttable>
      </section>

      <section title="OPTION_S46_DMR (91) to Softwire46-DMR">
        <texttable>
          <ttcol align="center">OPTION_S46_BR Field</ttcol>

          <ttcol align="center">Softwire46-DMR Subfield</ttcol>

          <c>dmr-prefix6-len</c>

          <c>dmr-prefix6-len</c>

          <c>dmr-ipv6-prefix</c>

          <c>dmr-ipv6-prefix</c>
        </texttable>
      </section>

      <section title="OPTION_S46_V4V6BIND (92) to Softwire46-V4V6Bind">
        <texttable>
          <ttcol align="center">OPTION_S46_V4V6BIND Field</ttcol>

          <ttcol align="center">Softwire46-V4V6Bind Name</ttcol>

          <ttcol align="center">TLV Subfield</ttcol>

          <c>ipv4-address</c>

          <c>IPv4-Address</c>

          <c>ipv4-address</c>

          <c>bindprefix6-len</c>

          <c>Bind-IPv6-Prefix</c>

          <c>Prefix-Length</c>

          <c>bind-ipv6-prefix</c>

          <c>Bind-IPv6-Prefix</c>

          <c>bind-ipv6-prefix</c>
        </texttable>
      </section>

      <section title="OPTION_S46_PORTPARAMS (93) to Softwire46-PORTPARAMS Field Mappings">
        <texttable>
          <ttcol align="center">OPTION_S46_PORTPARAMS Field</ttcol>

          <ttcol align="center">Softwire46-PORTPARAMS Name</ttcol>

          <ttcol align="center">TLV Subfield</ttcol>

          <c>offset</c>

          <c>PSID-Offset</c>

          <c>PSID-Offset</c>

          <c>PSID-len</c>

          <c>PSID-Len</c>

          <c>PSID-len</c>

          <c>PSID</c>

          <c>PSID</c>

          <c>PSID</c>
        </texttable>
      </section>

      <section title="OPTION_S46_PRIORITY (111) to Softwire46-PORTPARAMS Field Mappings">
        <texttable>
          <ttcol align="center">OPTION_S46_PRIORITY Field</ttcol>

          <ttcol align="center">Softwire46-Priority Attribute Subfield</ttcol>

          <c>s46-option-code</c>

          <c>Softwire46-option-code</c>
        </texttable>
      </section>

      <section title="OPTION_V6_PREFIX64 (113) to Softwire46-Multicast Attribute Field Mappings">
        <texttable>
          <ttcol align="center">OPTION_V6_PREFIX64 Field</ttcol>

          <ttcol align="center">Softwire46-Multicast Attribute TLV
          Name</ttcol>

          <ttcol align="center">TLV Subfield</ttcol>

          <c>asm-length</c>

          <c>ASM-Prefix64</c>

          <c>Prefix-Length</c>

          <c>ASM_mPrefix64</c>

          <c>ASM-Prefix64</c>

          <c>asm-prefix64</c>

          <c>ssm-length</c>

          <c>SSM-Prefix64</c>

          <c>Prefix-Length</c>

          <c>SSM_mPrefix64</c>

          <c>SSM-Prefix64</c>

          <c>ssm-prefix64</c>

          <c>unicast-length</c>

          <c>U-Prefix64</c>

          <c>Prefix-Length</c>

          <c>uPrefix64</c>

          <c>U-Prefix64</c>

          <c>u-prefix64</c>
        </texttable>
      </section>
    </section>
  </back>
</rfc>
